# BEACON - ドキュメント分析とチェックリスト作成

## 1. アーキテクチャ概要

BEACON（Building & Engineering Approval Compliance Navigator）は、不動産業界向けの AI ドキュメント適合性チェックシステムです。マルチモーダル LLM を活用して、申請書類や契約書が規制やチェックリストに適合しているかを自動的に確認します。

## 2. 処理フロー

```
┌───────────────┐
│ ドキュメント   │
│ アップロード   │
└───────┬───────┘
        │
        ▼
┌───────────────┐
│ S3に保存      │
└───────┬───────┘
        │
        ▼
┌───────────────┐
│ ファイル形式   │
│ 判定          │
└───────┬───────┘
        │
        ├─────────────────┬─────────────────┬─────────────────┐
        │                 │                 │                 │
        ▼                 ▼                 ▼                 ▼
┌───────────────┐  ┌───────────────┐  ┌───────────────┐  ┌───────────────┐
│ PDF処理       │  │ Word処理      │  │ Excel処理     │  │ 画像処理      │
└───────┬───────┘  └───────┬───────┘  └───────┬───────┘  └───────┬───────┘
        │                  │                  │                  │
        ▼                  ▼                  ▼                  │
┌───────────────┐  ┌───────────────┐  ┌───────────────┐         │
│ ページ分割    │  │ ページ分割    │  │ シート分割    │         │
└───────┬───────┘  └───────┬───────┘  └───────┬───────┘         │
        │                  │                  │                  │
        ▼                  ▼                  ▼                  │
┌───────────────────────────────────────────────────────────────┐
│                   各ページ/シートを処理                        │
└───────────────────────────────┬───────────────────────────────┘
                                │
                ┌───────────────┴───────────────┐
                │                               │
                ▼                               ▼
      ┌───────────────┐               ┌───────────────┐
      │ テキスト抽出  │               │ ページ画像    │
      │ ライブラリ    │               │ 生成          │
      └───────┬───────┘               └───────┬───────┘
              │                               │
              ▼                               ▼
      ┌───────────────┐               ┌───────────────┐
      │ プレーン      │               │ マルチモーダル │
      │ テキスト      │               │ LLM処理       │
      └───────┬───────┘               └───────┬───────┘
              │                               │
              │                               ▼
              │                       ┌───────────────┐
              │                       │ 構造化        │
              │                       │ Markdown      │
              │                       └───────┬───────┘
              │                               │
              └───────────────┬───────────────┘
                              │
                              ▼
                    ┌───────────────────┐
                    │ 結果の組み合わせ  │
                    │ (Combine)        │
                    └────────┬──────────┘
                             │
                             ▼
                    ┌───────────────────┐
                    │ 構造化ドキュメント │
                    │ 保存              │
                    └───────────────────┘
```

## 3. S3 ストレージ構造

```
s3://beacon-documents/
├── raw/                              # 元のドキュメント
│   └── {documentId}/
│       └── original.{pdf|docx|xlsx}
│
├── pages/                            # ページ分割結果
│   └── {documentId}/
│       ├── images/                   # ページ画像
│       │   ├── page-001.png
│       │   ├── page-002.png
│       │   └── ...
│       └── text/                     # テキスト抽出結果
│           ├── page-001.txt
│           ├── page-002.txt
│           └── ...
│
├── llm-results/                      # LLM処理結果
│   └── {documentId}/
│       ├── page-001.md              # ページごとのMarkdown
│       ├── page-002.md
│       └── ...
│
├── combined/                         # 統合結果
│   └── {documentId}/
│       ├── combined.md              # 統合Markdown
│       └── combined.json            # 構造化データ
│
└── checklists/                       # チェックリスト
    ├── raw/                         # 元のチェックリスト
    │   └── {checklistId}.{txt|xlsx}
    └── structured/                  # 構造化チェックリスト
        └── {checklistId}.json
```
